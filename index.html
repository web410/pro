<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FreeMusic Player - Full Songs</title>
    <script src="https://cdn.jsdelivr.net/npm/react@18.0.0/umd/react.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.0.0/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #121212 0%, #1e1e1e 100%);
            color: white;
            overflow-x: hidden;
        }
        .scroll-smooth {
            scroll-behavior: smooth;
        }
        .gradient-text {
            background: linear-gradient(90deg, #1DB954 0%, #1ED760 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .player-bar {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        .progress-bar {
            background: linear-gradient(90deg, #1DB954 0%, #1ED760 100%);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function App() {
            const [searchQuery, setSearchQuery] = useState('');
            const [searchResults, setSearchResults] = useState([]);
            const [currentView, setCurrentView] = useState('home');
            const [selectedTrack, setSelectedTrack] = useState(null);
            const [isPlaying, setIsPlaying] = useState(false);
            const [currentTrack, setCurrentTrack] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);
            const [playlists, setPlaylists] = useState([]);
            const [currentPlaylist, setCurrentPlaylist] = useState(null);
            const [queue, setQueue] = useState([]);
            const [currentQueueIndex, setCurrentQueueIndex] = useState(0);
            const [progress, setProgress] = useState(0);
            const [duration, setDuration] = useState(0);
            const [currentTime, setCurrentTime] = useState(0);
            const audioRef = useRef(null);
            const progressBarRef = useRef(null);

            const CORS_PROXY = 'https://cors.isomorphic-git.org/';

            // Jamendo API for full songs
            const JAMENDO_API = 'https://api.jamendo.com/v3.0/';
            const JAMENDO_CLIENT_ID = 'b7d7b6a0';

            const searchSongs = async (query, useJamendo = false) => {
                if (!query.trim()) return;
                
                setIsLoading(true);
                setError(null);
                
                try {
                    if (useJamendo) {
                        // Search Jamendo for full songs
                        const response = await fetch(`${JAMENDO_API}tracks/?client_id=${JAMENDO_CLIENT_ID}&format=jsonpretty&limit=20&search=${encodeURIComponent(query)}&include=audio&audiodownload_allowed=true`);
                        const data = await response.json();
                        setSearchResults(data.results || []);
                    } else {
                        // Search Deezer for metadata
                        const response = await fetch(`${CORS_PROXY}https://api.deezer.com/search?q=${encodeURIComponent(query)}&limit=20`);
                        const data = await response.json();
                        setSearchResults(data.data || []);
                    }
                    setCurrentView('results');
                } catch (err) {
                    setError('Failed to fetch songs. Please try again.');
                    console.error('Search error:', err);
                } finally {
                    setIsLoading(false);
                }
            };

            const getArtistTopSongs = async (artistId) => {
                setIsLoading(true);
                setError(null);
                
                try {
                    const response = await fetch(`${CORS_PROXY}https://api.deezer.com/artist/${artistId}/top?limit=10`);
                    const data = await response.json();
                    setSearchResults(data.data || []);
                    setCurrentView('results');
                } catch (err) {
                    setError('Failed to fetch artist songs. Please try again.');
                    console.error('Artist songs error:', err);
                } finally {
                    setIsLoading(false);
                }
            };

            const getAlbumTracks = async (albumId) => {
                setIsLoading(true);
                setError(null);
                
                try {
                    const response = await fetch(`${CORS_PROXY}https://api.deezer.com/album/${albumId}/tracks`);
                    const data = await response.json();
                    setSearchResults(data.data || []);
                    setCurrentView('results');
                } catch (err) {
                    setError('Failed to fetch album tracks. Please try again.');
                    console.error('Album tracks error:', err);
                } finally {
                    setIsLoading(false);
                }
            };

            const playTrack = async (track, useJamendo = false) => {
                setSelectedTrack(track);
                
                if (useJamendo) {
                    // Play full song from Jamendo
                    setCurrentTrack({
                        ...track,
                        audioUrl: track.audio,
                        preview: track.audio
                    });
                } else if (track.preview) {
                    // Play preview from Deezer
                    setCurrentTrack(track);
                } else if (track.audio) {
                    // Play full song from other source
                    setCurrentTrack(track);
                }
                
                setIsPlaying(true);
                
                if (audioRef.current) {
                    audioRef.current.src = track.preview || track.audioUrl || track.audio;
                    audioRef.current.play();
                }
                
                // Add to queue
                if (!queue.find(q => q.id === track.id)) {
                    setQueue([...queue, track]);
                }
            };

            const togglePlayPause = () => {
                if (audioRef.current) {
                    if (isPlaying) {
                        audioRef.current.pause();
                    } else {
                        audioRef.current.play();
                    }
                    setIsPlaying(!isPlaying);
                }
            };

            const playNext = () => {
                if (queue.length > 0 && currentQueueIndex < queue.length - 1) {
                    const nextTrack = queue[currentQueueIndex + 1];
                    playTrack(nextTrack, nextTrack.audio ? true : false);
                    setCurrentQueueIndex(currentQueueIndex + 1);
                }
            };

            const playPrevious = () => {
                if (queue.length > 0 && currentQueueIndex > 0) {
                    const prevTrack = queue[currentQueueIndex - 1];
                    playTrack(prevTrack, prevTrack.audio ? true : false);
                    setCurrentQueueIndex(currentQueueIndex - 1);
                }
            };

            const formatDuration = (duration) => {
                const minutes = Math.floor(duration / 60);
                const seconds = duration % 60;
                return `${minutes}:${seconds.toString().padStart(2, '0')}`;
            };

            const handleTimeUpdate = () => {
                if (audioRef.current) {
                    const current = audioRef.current.currentTime;
                    const total = audioRef.current.duration;
                    setCurrentTime(current);
                    setDuration(total);
                    setProgress((current / total) * 100);
                }
            };

            const handleSeek = (e) => {
                const percent = e.target.value;
                const newTime = (percent / 100) * duration;
                if (audioRef.current) {
                    audioRef.current.currentTime = newTime;
                }
            };

            const loadPlaylists = async () => {
                // Sample playlists (in real app, these would come from API)
                const samplePlaylists = [
                    { id: 1, name: 'Chill Vibes', tracks: 25, image: 'https://picsum.photos/seed/chill/300/300.jpg' },
                    { id: 2, name: 'Workout Mix', tracks: 18, image: 'https://picsum.photos/seed/workout/300/300.jpg' },
                    { id: 3, name: 'Focus Time', tracks: 32, image: 'https://picsum.photos/seed/focus/300/300.jpg' },
                    { id: 4, name: 'Party Hits', tracks: 45, image: 'https://picsum.photos/seed/party/300/300.jpg' }
                ];
                setPlaylists(samplePlaylists);
            };

            useEffect(() => {
                loadPlaylists();
            }, []);

            useEffect(() => {
                if (audioRef.current) {
                    audioRef.current.addEventListener('timeupdate', handleTimeUpdate);
                    audioRef.current.addEventListener('ended', playNext);
                    return () => {
                        if (audioRef.current) {
                            audioRef.current.removeEventListener('timeupdate', handleTimeUpdate);
                            audioRef.current.removeEventListener('ended', playNext);
                        }
                    };
                }
            }, [currentTrack]);

            const HomeView = () => (
                <div className="min-h-screen scroll-smooth">
                    {/* Header */}
                    <header className="glass-effect px-6 py-4 sticky top-0 z-40">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center space-x-3">
                                <i className="fas fa-music text-2xl gradient-text"></i>
                                <h1 className="text-2xl font-bold gradient-text">FreeMusic</h1>
                            </div>
                            <nav className="hidden md:flex space-x-8">
                                <button 
                                    onClick={() => setCurrentView('home')}
                                    className="text-white hover:text-green-400 transition-colors"
                                >
                                    Home
                                </button>
                                <button 
                                    onClick={() => setCurrentView('discover')}
                                    className="text-gray-400 hover:text-white transition-colors"
                                >
                                    Discover
                                </button>
                                <button 
                                    onClick={() => setCurrentView('library')}
                                    className="text-gray-400 hover:text-white transition-colors"
                                >
                                    Library
                                </button>
                            </nav>
                        </div>
                    </header>

                    {/* Hero Section */}
                    <section className="px-6 py-12">
                        <div className="max-w-4xl mx-auto text-center">
                            <h2 className="text-5xl md:text-6xl font-bold mb-6">
                                Free Music, <br />No Limits
                            </h2>
                            <p className="text-xl text-gray-300 mb-8">
                                Enjoy unlimited music streaming with our free player
                            </p>
                            <div className="max-w-2xl mx-auto">
                                <div className="relative">
                                    <input
                                        type="text"
                                        value={searchQuery}
                                        onChange={(e) => setSearchQuery(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && searchSongs(searchQuery, true)}
                                        placeholder="Search for songs, artists, or albums..."
                                        className="w-full px-6 py-4 rounded-full bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500"
                                    />
                                    <button 
                                        onClick={() => searchSongs(searchQuery, true)}
                                        className="absolute right-2 top-2 bg-green-500 text-white p-3 rounded-full hover:bg-green-600 transition-colors"
                                    >
                                        <i className="fas fa-search"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Quick Actions */}
                    <section className="px-6 pb-12">
                        <div className="max-w-6xl mx-auto">
                            <h3 className="text-2xl font-semibold mb-6">Quick Actions</h3>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div 
                                    onClick={() => setCurrentView('discover')}
                                    className="glass-effect rounded-xl p-6 cursor-pointer hover:bg-gray-800 transition-all transform hover:scale-105"
                                >
                                    <div className="text-4xl mb-4">
                                        <i className="fas fa-compass text-green-500"></i>
                                    </div>
                                    <h4 className="text-xl font-semibold mb-2">Discover</h4>
                                    <p className="text-gray-400">Explore trending music</p>
                                </div>
                                <div 
                                    onClick={() => setCurrentView('library')}
                                    className="glass-effect rounded-xl p-6 cursor-pointer hover:bg-gray-800 transition-all transform hover:scale-105"
                                >
                                    <div className="text-4xl mb-4">
                                        <i className="fas fa-heart text-red-500"></i>
                                    </div>
                                    <h4 className="text-xl font-semibold mb-2">Your Library</h4>
                                    <p className="text-gray-400">Access your favorite tracks</p>
                                </div>
                                <div 
                                    onClick={() => setCurrentView('radio')}
                                    className="glass-effect rounded-xl p-6 cursor-pointer hover:bg-gray-800 transition-all transform hover:scale-105"
                                >
                                    <div className="text-4xl mb-4">
                                        <i className="fas fa-broadcast-tower text-purple-500"></i>
                                    </div>
                                    <h4 className="text-xl font-semibold mb-2">Radio</h4>
                                    <p className="text-gray-400">Listen to curated stations</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Featured Playlists */}
                    <section className="px-6 pb-12">
                        <div className="max-w-6xl mx-auto">
                            <h3 className="text-2xl font-semibold mb-6">Featured Playlists</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                {playlists.map((playlist) => (
                                    <div key={playlist.id} className="glass-effect rounded-xl overflow-hidden cursor-pointer hover:opacity-90 transition-opacity">
                                        <div className="h-48 bg-gradient-to-br from-green-500 to-green-600"></div>
                                        <div className="p-4">
                                            <h4 className="font-semibold mb-1">{playlist.name}</h4>
                                            <p className="text-sm text-gray-400">{playlist.tracks} tracks</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </section>
                </div>
            );

            const ResultsView = () => (
                <div className="min-h-screen scroll-smooth">
                    {/* Header */}
                    <header className="glass-effect px-6 py-4 sticky top-0 z-40">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center space-x-4">
                                <button 
                                    onClick={() => setCurrentView('home')}
                                    className="text-gray-400 hover:text-white"
                                >
                                    <i className="fas fa-arrow-left text-xl"></i>
                                </button>
                                <h2 className="text-xl font-semibold">
                                    {searchQuery ? `"${searchQuery}"` : 'Search Results'}
                                </h2>
                            </div>
                            <div className="flex items-center space-x-4">
                                <button className="text-gray-400 hover:text-white">
                                    <i className="fas fa-filter"></i>
                                </button>
                                <button className="text-gray-400 hover:text-white">
                                    <i className="fas fa-sort"></i>
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* Results */}
                    <div className="px-6 py-6">
                        {isLoading ? (
                            <div className="flex justify-center items-center h-64">
                                <div className="text-center">
                                    <div className="inline-block animate-spin rounded-full h-12 w-12 border 
                                    {currentView === 'home' && <HomeView />}
                    {currentView === 'results' && <ResultsView />}
                    {currentView === 'discover' && <ResultsView />}
                    {currentView === 'library' && <ResultsView />}
                    {currentView === 'radio' && <ResultsView />}

                    {/* Player Bar */}
                    {currentTrack && (
                        <div className="fixed bottom-0 left-0 right-0 player-bar px-6 py-4 z-50">
                            <div className="flex items-center space-x-4">
                                <div className="w-12 h-12 bg-gray-700 rounded flex items-center justify-center">
                                    <i className="fas fa-music text-gray-400"></i>
                                </div>
                                <div className="flex-1">
                                    <h4 className="font-semibold text-sm">{currentTrack.name || currentTrack.title}</h4>
                                    <p className="text-xs text-gray-400">{currentTrack.artist?.name || currentTrack.artist}</p>
                                </div>
                                <div className="flex items-center space-x-4">
                                    <button className="text-gray-400 hover:text-white">
                                        <i className="fas fa-step-backward"></i>
                                    </button>
                                    <button 
                                        onClick={togglePlayPause}
                                        className="bg-green-500 text-white p-2 rounded-full hover:bg-green-600 transition-colors"
              >
                                        <i className={`fas ${isPlaying ? 'fa-pause' : 'fa-play'}`}></i>
                                    </button>
                                    <button className="text-gray-400 hover:text-white">
                                        <i className="fas fa-step-forward"></i>
                                    </button>
                                </div>
                                <div className="flex items-center space-x-2">
                                    <i className="fas fa-volume-up text-gray-400"></i>
                                    <div className="w-24 h-1 bg-gray-600 rounded-full">
                                        <div className="w-1/2 h-full bg-green-500 rounded-full"></div>
                                    </div>
                                </div>
                            </div>
                            
                            {/* Progress Bar */}
                            <div className="mt-4">
                                <div className="flex justify-between text-xs text-gray-400 mb-1">
                                    <span>{formatDuration(currentTime)}</span>
                                    <span>{formatDuration(duration)}</span>
                                </div>
                                <input
                                    ref={progressBarRef}
                                    type="range"
                                    min="0"
                                    max="100"
                                    value={progress}
                                    onChange={handleSeek}
                                    className="w-full h-1 bg-gray-600 rounded-full appearance-none cursor-pointer progress-bar"
                                />
                            </div>
                        </div>
                    )}

                    {/* Hidden Audio Element */}
                    <audio 
                        ref={audioRef}
                        onEnded={() => setIsPlaying(false)}
                        onError={(e) => console.error('Audio error:', e)}
                    />

                    {/* Mobile Navigation */}
                    <div className="md:hidden fixed bottom-0 left-0 right-0 bg-gray-900 border-t border-gray-800">
                        <div className="flex justify-around py-2">
                            <button 
                                onClick={() => setCurrentView('home')}
                                className={`flex flex-col items-center p-2 ${currentView === 'home' ? 'text-green-500' : 'text-gray-400'}`}
                            >
                                <i className="fas fa-home text-xl"></i>
                                <span className="text-xs mt-1">Home</span>
                            </button>
                            <button 
                                onClick={() => setCurrentView('discover')}
                                className={`flex flex-col items-center p-2 ${currentView === 'discover' ? 'text-green-500' : 'text-gray-400'}`}
                            >
                                <i className="fas fa-compass text-xl"></i>
                                <span className="text-xs mt-1">Discover</span>
                            </button>
                            <button 
                                onClick={() => setCurrentView('library')}
                                className={`flex flex-col items-center p-2 ${currentView === 'library' ? 'text-green-500' : 'text-gray-400'}`}
                            >
                                <i className="fas fa-heart text-xl"></i>
                                <span className="text-xs mt-1">Library</span>
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
